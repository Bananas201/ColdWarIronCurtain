launch_operation_effect = {
	add_to_variable = { 
		current_operations = 1
	}
	if = {
		limit = {
			check_variable = {
				current_operations = 1
			}	
		}
		set_variable = {
			slot_one_target = selected_operation_index_target
		}
		set_variable = {
			slot_one_personnel_target = selected_operation_personnel_target
		}
		
		set_variable = {
			selected_squad_slot_1_Current_Page_Ref = selected_squad_origin
		}
		set_variable = {
			selected_squad_slot_1 = selected_squad_origin
		}
		add_to_variable = {
			selected_squad_slot_1 = -1
		}
		set_variable = {
			paramilitary_squad_id_status^selected_squad_slot_1 = 2
		}
		set_variable = {
			slot_one_time_duration = selected_operation_index_mission_duration
		}
		set_variable = {
			slot_one_mission_token = selected_operation_index_id_token
		}
		add_to_array = {
			current_operation_list = selected_operation_index_id_token
		}
		set_variable = {
			slot_one_risk = selected_operation_index_risk
		}
		adjust_operation_risk_modifier = yes
		set_variable = {
			slot_one_actual_risk = selected_operation_index_risk
		}
		subtract_from_variable = {
			currentMoney = selected_operation_index_cost
		}
		activate_mission = Espionage_Operation_Slot_1
	}
}
adjust_operation_risk_modifier = {
	if = {
		limit = {
			selected_operation_index_risk = 1
		}
		set_variable = {
			selected_operation_index_risk = 0.10
		}
	}
	else_if = {
		limit = {
			selected_operation_index_risk = 2
		}
		set_variable = {
			selected_operation_index_risk = 0.25
		}
	}
	else_if = {
		limit = {
			selected_operation_index_risk = 3
		}
		set_variable = {
			selected_operation_index_risk = 0.40
		}
	}
	else_if = {
		limit = {
			selected_operation_index_risk = 4
		}
		set_variable = {
			selected_operation_index_risk = 0.55
		}
	}
	else_if = {
		limit = {
			selected_operation_index_risk = 5
		}
		set_variable = {
			selected_operation_index_risk = 0.70
		}
	}
	else_if = {
		limit = {
			selected_operation_index_risk = 6
		}
		set_variable = {
			selected_operation_index_risk = 0.85
		}
	}
	else = { }
}
operation_closeout_effect = {
	if = {	
		limit = {
			check_variable = 1 #Setting up Blacksite
		}
		set_variable = {
			success_chance = 0.99
		}
		#set_variable_to_random = success_chance
		if = {	#Success
			limit = {
				OR = {
					check_variable = {
						current_actual_risk > success_chance
					}
					check_variable = {
						current_actual_risk = success_chance
					}
				}
			}
			set_variable = {
				current_page = selected_squad_slot_1_Current_Page_Ref
			}
			meta_effect = { 
				text = {
					add_to_array = {
						array = black_ops_group_[ARRAY_NUMBER]_history
						value = global.date      #Established Date
					}
					add_to_array = {
						array = black_ops_group_[ARRAY_NUMBER]_history_entry
						value = current_token
					}
					add_to_array = {
						array = black_ops_group_[ARRAY_NUMBER]_history_entry_flag
						value = history_target.id      
					}
					add_to_array = {
						array = black_ops_group_[ARRAY_NUMBER]_history_entry_status
						value = 1
					}
				}
				ARRAY_NUMBER = "[?selected_squad_slot_1_Current_Page_Ref]"
			}    
			randomize_variable = {
				var = slot_1_operative_1_experience_gain
				distribution = uniform
				min = 1
				max = 10
			}
			randomize_variable = {
				var = slot_1_operative_2_experience_gain
				distribution = uniform
				min = 1
				max = 10
			}
			randomize_variable = {
				var = slot_1_operative_3_experience_gain
				distribution = uniform
				min = 1
				max = 10
			}
			randomize_variable = {
				var = slot_1_operative_4_experience_gain
				distribution = uniform
				min = 1
				max = 10
			}
			randomize_variable = {
				var = slot_1_operative_5_experience_gain
				distribution = uniform
				min = 1
				max = 10
			}
			round_variable = slot_1_operative_1_experience_gain
			round_variable = slot_1_operative_2_experience_gain
			round_variable = slot_1_operative_3_experience_gain
			round_variable = slot_1_operative_4_experience_gain
			round_variable = slot_1_operative_5_experience_gain
			add_to_variable = {
				operative_1_current_experience^selected_squad_slot_1_Current_Page_Ref = slot_1_operative_1_experience_gain
			}
			add_to_variable = {
				operative_2_current_experience^selected_squad_slot_1_Current_Page_Ref = slot_1_operative_2_experience_gain
			}
			add_to_variable = {
				operative_3_current_experience^selected_squad_slot_1_Current_Page_Ref = slot_1_operative_3_experience_gain
			}
			add_to_variable = {
				operative_4_current_experience^selected_squad_slot_1_Current_Page_Ref = slot_1_operative_4_experience_gain
			}
			add_to_variable = {
				operative_5_current_experience^selected_squad_slot_1_Current_Page_Ref = slot_1_operative_5_experience_gain
			}
			set_variable = {
				paramilitary_slot_one_bulletin = 1
			}

			set_variable = { espionage_network_status^history_target = 1 }
		}
		else = {	#Failure
		set_variable_to_random = success_chance
		if = {	#Success
			limit = {
				OR = {
					check_variable = {
						current_actual_risk > success_chance
					}
					check_variable = {
						current_actual_risk = success_chance
					}
				}
			}
			set_variable = {
				current_page = selected_squad_slot_1_Current_Page_Ref
			}
			meta_effect = { 
				text = {
					add_to_array = {
						array = black_ops_group_[ARRAY_NUMBER]_history
						value = global.date      #Established Date
					}
					add_to_array = {
						array = black_ops_group_[ARRAY_NUMBER]_history_entry
						value = current_token
					}
					add_to_array = {
						array = black_ops_group_[ARRAY_NUMBER]_history_entry_flag
						value = history_target.id      
					}
					add_to_array = {
						array = black_ops_group_[ARRAY_NUMBER]_history_entry_status
						value = 2    
					}

				}
				ARRAY_NUMBER = "[?selected_squad_slot_1_Current_Page_Ref]"
			}    
			randomize_variable = {
				var = slot_1_operative_1_experience_gain
				distribution = uniform
				min = 1
				max = 5
			}
			randomize_variable = {
				var = slot_1_operative_2_experience_gain
				distribution = uniform
				min = 1
				max = 5
			}
			randomize_variable = {
				var = slot_1_operative_3_experience_gain
				distribution = uniform
				min = 1
				max = 5
			}
			randomize_variable = {
				var = slot_1_operative_4_experience_gain
				distribution = uniform
				min = 1
				max = 5
			}
			randomize_variable = {
				var = slot_1_operative_5_experience_gain
				distribution = uniform
				min = 1
				max = 5
			}
			round_variable = slot_1_operative_1_experience_gain
			round_variable = slot_1_operative_2_experience_gain
			round_variable = slot_1_operative_3_experience_gain
			round_variable = slot_1_operative_4_experience_gain
			round_variable = slot_1_operative_5_experience_gain
			add_to_variable = {
				operative_1_current_experience^selected_squad_slot_1_Current_Page_Ref = slot_1_operative_1_experience_gain
			}
			add_to_variable = {
				operative_2_current_experience^selected_squad_slot_1_Current_Page_Ref = slot_1_operative_2_experience_gain
			}
			add_to_variable = {
				operative_3_current_experience^selected_squad_slot_1_Current_Page_Ref = slot_1_operative_3_experience_gain
			}
			add_to_variable = {
				operative_4_current_experience^selected_squad_slot_1_Current_Page_Ref = slot_1_operative_4_experience_gain
			}
			add_to_variable = {
				operative_5_current_experience^selected_squad_slot_1_Current_Page_Ref = slot_1_operative_5_experience_gain
			}
			set_variable = {
				paramilitary_slot_one_bulletin = 1
			}

		}

	}
	else_if = {
		limit = {
			check_variable = {
				current_token = 100
			}
		}
		set_country_flag = Cuban_Emigre_Contacts_Token
		set_variable = {
			current_page = selected_squad_slot_1_Current_Page_Ref
		}
		meta_effect = { 
			text = {
				add_to_array = {
					array = black_ops_group_[ARRAY_NUMBER]_history
					value = global.date      #Established Date
				}
				add_to_array = {
					array = black_ops_group_[ARRAY_NUMBER]_history_entry
					value = current_token
				}
				add_to_array = {
					array = black_ops_group_[ARRAY_NUMBER]_history_entry_flag
					value = history_target.id      
				}
			}
			ARRAY_NUMBER = "[?selected_squad_slot_1_Current_Page_Ref]"
		}    
		randomize_variable = {
			var = slot_1_operative_1_experience_gain
			distribution = uniform
			min = 1
			max = 10
		}
		randomize_variable = {
			var = slot_1_operative_2_experience_gain
			distribution = uniform
			min = 1
			max = 10
		}
		randomize_variable = {
			var = slot_1_operative_3_experience_gain
			distribution = uniform
			min = 1
			max = 10
		}
		randomize_variable = {
			var = slot_1_operative_4_experience_gain
			distribution = uniform
			min = 1
			max = 10
		}
		randomize_variable = {
			var = slot_1_operative_5_experience_gain
			distribution = uniform
			min = 1
			max = 10
		}
		round_variable = slot_1_operative_1_experience_gain
		round_variable = slot_1_operative_2_experience_gain
		round_variable = slot_1_operative_3_experience_gain
		round_variable = slot_1_operative_4_experience_gain
		round_variable = slot_1_operative_5_experience_gain
		add_to_variable = {
			operative_1_current_experience^selected_squad_slot_1_Current_Page_Ref = slot_1_operative_1_experience_gain
		}
		add_to_variable = {
			operative_2_current_experience^selected_squad_slot_1_Current_Page_Ref = slot_1_operative_2_experience_gain
		}
		add_to_variable = {
			operative_3_current_experience^selected_squad_slot_1_Current_Page_Ref = slot_1_operative_3_experience_gain
		}
		add_to_variable = {
			operative_4_current_experience^selected_squad_slot_1_Current_Page_Ref = slot_1_operative_4_experience_gain
		}
		add_to_variable = {
			operative_5_current_experience^selected_squad_slot_1_Current_Page_Ref = slot_1_operative_5_experience_gain
		}
		set_variable = {
			paramilitary_slot_one_bulletin = 1
		}
	}
	
}