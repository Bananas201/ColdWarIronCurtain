 GetJapaneseSeatsPercentages = {
    set_variable = { JapaneseSeatTotal = 0 } 
	#
    add_to_variable = {	JapaneseSeatTotal = JAP_Seats1 }
    add_to_variable = {	JapaneseSeatTotal = JAP_Seats2 }
    add_to_variable = {	JapaneseSeatTotal = JAP_Seats3 }
    add_to_variable = {	JapaneseSeatTotal = JAP_Seats4 }
    add_to_variable = {	JapaneseSeatTotal = JAP_Seats5 }
    add_to_variable = {	JapaneseSeatTotal = JAP_Seats6 }

    set_variable = { JapanesePartySeats1 = ReligionChristianityJapanesePartySeats1 }
    set_variable = { JapanesePartySeats2 = ReligionChristianityJapanesePartySeats2 }
    set_variable = { JapanesePartySeats3 = ReligionChristianityJapanesePartySeats3 }
    set_variable = { JapanesePartySeats4 = ReligionChristianityJapanesePartySeats4 }
    set_variable = { JapanesePartySeats5 = ReligionJudaism }
    set_variable = { JapanesePartySeats6 = ReligionIslamJapanesePartySeats6 }

    divide_variable = { JapanesePartySeats1 = JapaneseSeatTotal }
    divide_variable = { JapanesePartySeats2 = JapaneseSeatTotal }
    divide_variable = { JapanesePartySeats3 = JapaneseSeatTotal }
    divide_variable = { JapanesePartySeats4 = JapaneseSeatTotal }
    divide_variable = { JapanesePartySeats5 = JapaneseSeatTotal }
    divide_variable = { JapanesePartySeats6 = JapaneseSeatTotal }

    clear_array = japanese_party_percentage
    
	multiply_variable = { JapanesePartySeats1 = 100 }
	round_variable = JapanesePartySeats1
	add_to_array = { japanese_party_percentage = JapanesePartySeats1 }
    
	multiply_variable = { JapanesePartySeats2 = 100 }
	round_variable = JapanesePartySeats2
	add_to_array = { japanese_party_percentage = JapanesePartySeats2 }
    
	multiply_variable = { JapanesePartySeats3 = 100 }
	round_variable = JapanesePartySeats3
	add_to_array = { japanese_party_percentage = JapanesePartySeats3 }
    
	multiply_variable = { JapanesePartySeats4 = 100 }
	round_variable = JapanesePartySeats4
	add_to_array = { japanese_party_percentage = JapanesePartySeats4 }
    
	multiply_variable = { JapanesePartySeats5 = 100 }
	round_variable = JapanesePartySeats5
	add_to_array = { japanese_party_percentage = JapanesePartySeats5 }
    
	multiply_variable = { JapanesePartySeats6 = 100 }
	round_variable = JapanesePartySeats6
	add_to_array = { japanese_party_percentage = JapanesePartySeats6 }
    
    clear_array = party_id 

    add_to_array = { party_id = 1 }
    add_to_array = { party_id = 2 }
    add_to_array = { party_id = 3 }
    add_to_array = { party_id = 4 }
    add_to_array = { party_id = 5 }
    add_to_array = { party_id = 6 }

	set_temp_variable = { length_temp = japanese_party_percentage^num }
	for_loop_effect = {
		start = 0
		end = length_temp
		add = 1
		value = v
		break = b
		
		find_highest_in_array = {
			array = japanese_party_percentage
			value = v
			index = ii
		}
		remove_from_array = {
			array = japanese_party_percentage
			index = ii
		}
		add_to_temp_array = { 
			array = japanese_party_percentage_temp
			value = v
		}
		set_temp_variable = { party_id_temp_var = party_id^ii }
		remove_from_array = {
			array = party_id
			index = ii
		}
		add_to_temp_array = { 
			array = party_id_temp
			value = party_id_temp_var  
		}
	}
	for_loop_effect = {
		start = 0
		end = length_temp
		add = 1
		value = v
		break = b
		
		add_to_array = { 
			array = japanese_party_percentage
			value = japanese_party_percentage_temp^v
		}
		add_to_array = { 
			array = party_id
			value = party_id_temp^v 
		}
	}
 }

# Scripted GUI Pie Chart example by Yard1
# Feel free to use in your mods, but give credits to Yard1 (both in code, with comments; and on your download page)

# this creates a pie chart of popularities - can be easily adapted to show anything that adds up to 100%
create_japanese_seat_pie_chart = {
	clear_array = jap_pie_chart
	resize_array = {
		array = jap_pie_chart
		value = 1 # 1 is value for neutrality frame, so we don't have to make a loop for it
		size = 100 # 100 pieces, each percent is one piece
	}
	set_temp_variable = { JapanesePartySeats1_pop = JapanesePartySeats1 }
	#multiply_temp_variable = { JapanesePartySeats1_pop = 100 }
	round_temp_variable = JapanesePartySeats1_pop

	set_temp_variable = { JapanesePartySeats2_pop = JapanesePartySeats2 }
	#multiply_temp_variable = { JapanesePartySeats2_pop = 100 }
	round_temp_variable = JapanesePartySeats2_pop 
	set_variable = { ROOT.last_idx = JapanesePartySeats1_pop }
	add_to_temp_variable = { JapanesePartySeats2_pop = ROOT.last_idx }
	for_loop_effect = {
		start = ROOT.last_idx
		end = JapanesePartySeats2_pop
		set_variable = { jap_pie_chart^v = 2 }
		add_to_variable = { ROOT.last_idx = 1 }
	}

	set_temp_variable = { JapanesePartySeats3_pop = JapanesePartySeats3 }
	#multiply_temp_variable = { JapanesePartySeats3_pop = 100 }
	round_temp_variable = JapanesePartySeats3_pop
	add_to_temp_variable = { JapanesePartySeats3_pop = ROOT.last_idx }
	for_loop_effect = {
		start = ROOT.last_idx
		end = JapanesePartySeats3_pop
		set_variable = { jap_pie_chart^v = 3 }
		add_to_variable = { ROOT.last_idx = 1 }
	}

	set_temp_variable = { JapanesePartySeats4_pop = JapanesePartySeats4 }
	#multiply_temp_variable = { JapanesePartySeats4_pop = 100 }
	round_temp_variable = JapanesePartySeats4_pop 
	add_to_temp_variable = { JapanesePartySeats4_pop = ROOT.last_idx }
	for_loop_effect = {
		start = ROOT.last_idx
		end = JapanesePartySeats4_pop
		set_variable = { jap_pie_chart^v = 4 }
		add_to_variable = { ROOT.last_idx = 1 }
	}
	set_temp_variable = { JapanesePartySeats5_pop = JapanesePartySeats5 }
	#multiply_temp_variable = { JapanesePartySeats5_pop = 100 }
	round_temp_variable = JapanesePartySeats5_pop 
	add_to_temp_variable = { JapanesePartySeats5_pop = ROOT.last_idx }
	for_loop_effect = {
		start = ROOT.last_idx
		end = JapanesePartySeats5_pop
		set_variable = { jap_pie_chart^v = 5 }
		add_to_variable = { ROOT.last_idx = 1 }
	}
	set_temp_variable = { JapanesePartySeats6_pop = JapanesePartySeats6 }
	#multiply_temp_variable = { JapanesePartySeats6_pop = 100 }
	round_temp_variable = JapanesePartySeats6_pop 
	add_to_temp_variable = { JapanesePartySeats6_pop = ROOT.last_idx }
	for_loop_effect = {
		start = ROOT.last_idx
		end = JapanesePartySeats6_pop
		set_variable = { jap_pie_chart^v = 6 }
		add_to_variable = { ROOT.last_idx = 1 }
	}

	clear_variable = ROOT.last_idx
	add_to_variable = { pie_chart_dirty = 1 }
}
